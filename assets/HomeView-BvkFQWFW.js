import{_ as g,a as s}from"./index-EZjxmscV.js";import{a as L}from"./axios-xsH4HHeE.js";import{r as c,j as E,k as z,c as k,l as d,o as I}from"./vue-CluIPJnQ.js";import{u as T,i as A,a as B,b as O,c as P,d as S,e as V,f as R}from"./echarts-BqiCTMEy.js";const $={class:"home"},D={class:"charts"},j={__name:"HomeView",setup(G){T([B,O,P,S,V,R]);const m=c(null),p=c(null),n=c([]);let r=null,a=null;E(async()=>{try{const t=await L.get("http://localhost:3000/buildings");n.value=t.data,u(),_()}catch(t){console.error("数据获取失败:",t)}});async function u(){const t=await s(()=>import("./echarts-BqiCTMEy.js").then(e=>e.j),[]),{BarChart:o}=await s(async()=>{const{BarChart:e}=await import("./echarts-BqiCTMEy.js").then(i=>i.k);return{BarChart:e}},[]),{TitleComponent:l,TooltipComponent:h,LegendComponent:f,GridComponent:v}=await s(async()=>{const{TitleComponent:e,TooltipComponent:i,LegendComponent:C,GridComponent:b}=await import("./echarts-BqiCTMEy.js").then(x=>x.l);return{TitleComponent:e,TooltipComponent:i,LegendComponent:C,GridComponent:b}},[]),{CanvasRenderer:y}=await s(async()=>{const{CanvasRenderer:e}=await import("./echarts-BqiCTMEy.js").then(i=>i.r);return{CanvasRenderer:e}},[]);t.use([o,l,h,f,v,y]),r=t.init(m.value);const w={title:{text:"月度能耗总览",left:"center",textStyle:{fontSize:16}},tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},legend:{data:["用电量","用水量"],top:30},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",data:n.value.map(e=>e.name),axisLabel:{rotate:45}},yAxis:[{type:"value",name:"用电量 (kWh)",axisLabel:{formatter:"{value}"}},{type:"value",name:"用水量 (吨)",axisLabel:{formatter:"{value}"}}],series:[{name:"用电量",type:"bar",data:n.value.map(e=>e.monthly.electricity),itemStyle:{color:"#5470c6"}},{name:"用水量",type:"bar",yAxisIndex:1,data:n.value.map(e=>e.monthly.water),itemStyle:{color:"#91cc75"}}]};r.setOption(w),window.addEventListener("resize",r.resize)}function _(){a&&a.dispose(),a=A(p.value),n.value.reduce((o,l)=>o+l.monthly.electricity,0);const t={title:{text:"用电量占比",left:"center",textStyle:{fontSize:16}},tooltip:{trigger:"item",formatter:"{a} <br/>{b}: {c} kWh ({d}%)"},legend:{orient:"vertical",left:"left",top:30},series:[{name:"用电量占比",type:"pie",radius:"50%",data:n.value.map(o=>({value:o.monthly.electricity,name:o.name})),label:{formatter:"{b}: {d}%"},emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]};a.setOption(t),window.addEventListener("resize",a.resize)}return z(()=>{r&&(r.dispose(),window.removeEventListener("resize",r.resize)),a&&(a.dispose(),window.removeEventListener("resize",a.resize))}),(t,o)=>(I(),k("div",$,[d("div",D,[d("div",{ref_key:"barChart",ref:m,class:"chart"},null,512),d("div",{ref_key:"pieChart",ref:p,class:"chart"},null,512)])]))}},U=g(j,[["__scopeId","data-v-fbc555ca"]]);export{U as default};
